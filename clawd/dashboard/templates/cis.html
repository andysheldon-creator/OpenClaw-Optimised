<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIS - Clawd Dashboard</title>
    <link rel="stylesheet" href="/static/design-system.css">
</head>
<body>
    <div class="app">
        <header class="app-header">
            <div class="app-header-content">
                <nav class="main-nav">
                    <a href="/" class="nav-link" data-module="dashboard">ðŸ¦ž Dashboard</a>
                    <a href="/cis.html" class="nav-link active" data-module="cis">Content Intelligence</a>
                    <a href="/sticker-business.html" class="nav-link" data-module="sticker">Stickers</a>
                    <a href="/ceramics-intelligence.html" class="nav-link" data-module="ceramics">Ceramics</a>
                    <a href="/natural-capture.html" class="nav-link" data-module="capture">Capture</a>
                    <a href="/cicd.html" class="nav-link" data-module="cicd">CI/CD</a>
                </nav>
                <h1 class="app-title">Content Intelligence System</h1>
                <p class="app-subtitle">RSS Harvesting â€¢ Insight Extraction â€¢ PARA Routing</p>
            </div>
        </header>

        <main class="app-body">
            <div class="app-content">
                <!-- Stats Bar -->
                <div class="stats-bar">
                    <div class="stat-card accent-cis">
                        <div class="stat-value" id="articles-count">130</div>
                        <div class="stat-label">Articles</div>
                    </div>
                    <div class="stat-card accent-cis">
                        <div class="stat-value" id="insights-count">544</div>
                        <div class="stat-label">Insights</div>
                    </div>
                    <div class="stat-card accent-cis">
                        <div class="stat-value" id="sources-count">6</div>
                        <div class="stat-label">Sources</div>
                    </div>
                    <div class="stat-card accent-cis">
                        <div class="stat-value" id="last-harvest">--</div>
                        <div class="stat-label">Last Harvest</div>
                    </div>
                </div>

                <!-- Source Cards -->
                <div class="grid-3 mb-lg">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Nate Jones</div>
                            <span class="badge badge-success">High</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">21</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">91</div>
                                </div>
                            </div>
                            <a href="https://natesnewsletter.substack.com/" target="_blank" class="btn btn-sm btn-subtle mt-md">Visit Source â†’</a>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Slow AI</div>
                            <span class="badge badge-success">High</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">20</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">97</div>
                                </div>
                            </div>
                            <a href="https://theslowai.substack.com/" target="_blank" class="btn btn-sm btn-subtle mt-md">Visit Source â†’</a>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Rhys Morgan</div>
                            <span class="badge badge-success">High</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">30</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">78</div>
                                </div>
                            </div>
                            <a href="https://rhysmorgan.substack.com/" target="_blank" class="btn btn-sm btn-subtle mt-md">Visit Source â†’</a>
                        </div>
                    </div>
                </div>

                <!-- More Sources -->
                <div class="grid-3 mb-lg">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Aakash Gupta</div>
                            <span class="badge badge-subtle">Medium</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">20</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">90</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">NEW ECONOMIES</div>
                            <span class="badge badge-subtle">Medium</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">19</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">95</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">Sabrina Ramonov</div>
                            <span class="badge badge-success">High</span>
                        </div>
                        <div class="card-body">
                            <div class="grid-2">
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Articles</div>
                                    <div class="stat-value" style="font-size:1.5rem;">20</div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size:0.75rem;">Insights</div>
                                    <div class="stat-value" style="font-size:1.5rem;">91</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PARA Distribution -->
                <div class="card mb-lg">
                    <div class="card-header">
                        <div class="card-title">PARA Distribution</div>
                    </div>
                    <div class="card-body">
                        <div class="grid-3">
                            <div class="stat-card" style="background:var(--accent-projects);">
                                <div class="stat-value">38</div>
                                <div class="stat-label">Projects (6%)</div>
                            </div>
                            <div class="stat-card" style="background:var(--accent-areas);">
                                <div class="stat-value">449</div>
                                <div class="stat-label">Areas (71%)</div>
                            </div>
                            <div class="stat-card" style="background:var(--accent-resources);">
                                <div class="stat-value">143</div>
                                <div class="stat-label">Resources (23%)</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Actions</div>
                    </div>
                    <div class="card-body">
                        <div class="flex gap-md">
                            <button class="btn btn-primary" onclick="harvestFeed()">Harvest All Feeds</button>
                            <button class="btn btn-secondary" onclick="extractInsights()">Extract Insights</button>
                            <button class="btn btn-subtle" onclick="viewRawData()">View Raw Data</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        async function harvestFeed() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Harvesting...';
            
            try {
                const res = await fetch('/api/cis/harvest', { method: 'POST' });
                const data = await res.json();
                if (data.success) {
                    location.reload();
                } else {
                    alert('Harvest failed: ' + data.error);
                }
            } catch (err) {
                alert('Error: ' + err.message);
            }
            
            btn.disabled = false;
            btn.textContent = 'Harvest All Feeds';
        }

        async function extractInsights() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Extracting...';
            
            try {
                const res = await fetch('/api/cis/extract', { method: 'POST' });
                const data = await res.json();
                if (data.success) {
                    alert('Insight extraction started. Check back in a few minutes.');
                } else {
                    alert('Extraction failed: ' + data.error);
                }
            } catch (err) {
                alert('Error: ' + err.message);
            }
            
            btn.disabled = false;
            btn.textContent = 'Extract Insights';
        }

        function viewRawData() {
            window.open('/content-intelligence/', '_blank');
        }

        // Fetch stats on load
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/api/cis/stats').then(r => r.json()).then(data => {
                if (data.articles) document.getElementById('articles-count').textContent = data.articles;
                if (data.insights) document.getElementById('insights-count').textContent = data.insights;
            });
        });
    </script>
</body>
</html>